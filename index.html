<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TRAVEL EXPLORE</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="dharshan/chatbot.css" />
</head>

<body>

<!-- ==== HEADERS ==== -->
<div id="logged-out-header" class="top-links">
    <a href="signup.html"><h3>Sign Up</h3></a>
    <a href="login.html"><h3>Sign In</h3></a>
    <a href="https://www.google.co.in/"><h3>ğŸ” Search</h3></a>
</div>

<div id="logged-in-header" class="top-links" style="display: none;">
    <a href="#" id="menu-toggle" class="menu-icon">â˜°</a>
    <a href="https://www.google.co.in/"><h3>ğŸ” Search</h3></a>
    <a href="profile.html" class="user-icon">ğŸ‘¤</a>
</div>

<!-- ==== SIDEBAR ==== -->
<div id="sidebar-menu" class="sidebar">
    <a href="index.html" class="active-link">ğŸ  Home</a>
    <a href="index2.html">ğŸ—ºï¸ Explore</a>
    <a href="index3.html">â„¹ï¸ About us</a>
    <a href="feedback.html">ğŸ—£ï¸ Feedback</a>
    <a href="index4.html">ğŸ“… Trip Planner</a>
    <hr />
    <a href="profile.html">âš™ï¸ Settings / Profile</a>
    <a href="#" id="logout-link" class="logout-link">ğŸšª Log Out</a>
</div>

<h1 style="text-align: center; color: #007bff"><i>Discover Places Near You</i></h1>
<h4 style="text-align: center; color: #555"><i>This is the best guide of your city</i></h4>

<!-- ==== CATEGORY SECTION ==== -->
<div class="section">
    <a href="#" onclick="findNearby('Hotels'); return false;">
        <img src="hotels.jpeg" /><h3><i>Hotels</i></h3>
    </a>
    <a href="#" onclick="findNearby('Restaurants'); return false;">
        <img src="restra.jpeg" /><h3><i>Restaurants</i></h3>
    </a>
    <a href="#" onclick="findNearby('Shopping Malls'); return false;">
        <img src="shopping.jpeg" /><h3><i>Shopping</i></h3>
    </a>
    <a href="#" onclick="findNearby('Tourist Attractions'); return false;">
        <img src="travel.jpeg" /><h3><i>Travels</i></h3>
    </a>
    <a href="#" onclick="findNearby('Cinema Theatres'); return false;">
        <img src="cinema.jpeg" /><h3><i>Cinema</i></h3>
    </a>
</div>

<!-- ==== EXPLORE CITIES ==== -->
<section class="explore-section">
    <h2>Explore Top Destinations</h2>
    <div class="destination-grid">
        <div class="destination-card" onclick="openMap('Varanasi')"><img src="varanasi.jpg"><h3>Varanasi</h3></div>
        <div class="destination-card" onclick="openMap('Goa')"><img src="goa.jpg"><h3>Goa</h3></div>
        <div class="destination-card" onclick="openMap('New Delhi')"><img src="delhi.jpg"><h3>New Delhi</h3></div>
        <div class="destination-card" onclick="openMap('Jaipur')"><img src="jaipur.jpg"><h3>Jaipur</h3></div>
        <div class="destination-card" onclick="openMap('Kerala')"><img src="kerala.jpg"><h3>Kerala</h3></div>
        <div class="destination-card" onclick="openMap('Ladakh')"><img src="ladakh.jpg"><h3>Ladakh</h3></div>
    </div>
</section>

<!-- ==== MAP ==== -->
<section id="map-results">
    <h2>Nearby Results (Map View)</h2>
    <iframe id="map-frame" width="100%" height="500" style="border-radius:10px;" loading="lazy"></iframe>
</section>

<!-- ==== CHATBOT ==== -->
<button id="chat-toggle">ğŸ’¬</button>
<div id="chatbot-box">
    <div id="chat-header">ğŸ¤– TravelMate</div>
    <div id="chat-body"></div>
    <input type="text" id="chat-input" placeholder="Type your message..." />
</div>

<!-- ==== JS ==== -->
<script type="module">
import { auth } from "./firebase.js";
import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

onAuthStateChanged(auth, (user) => {
    if (user) {
        document.getElementById("logged-out-header").style.display = "none";
        document.getElementById("logged-in-header").style.display = "flex";
        
        // âœ… This triggers Chrome GPS permission popup
        navigator.geolocation.getCurrentPosition(() => {}, () => {});
    } else {
        document.getElementById("logged-out-header").style.display = "flex";
        document.getElementById("logged-in-header").style.display = "none";
    }
});

document.getElementById("logout-link")?.addEventListener("click", (e) => {
    e.preventDefault();
    signOut(auth).then(() => location.reload());
});

// âœ… NEARBY PLACES (CORRECTED)
window.findNearby = function(place) {
    navigator.geolocation.getCurrentPosition((pos) => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;

        document.getElementById("map-frame").src =
        `https://maps.google.com/maps?q=${encodeURIComponent(place)}&near=${lat},${lon}&z=15&output=embed`;

    }, () => alert("Please ALLOW location to continue âœ…"));
};

// âœ… OPEN MAP FOR CITY
window.openMap = (city) => {
    document.getElementById("map-frame").src =
    `https://maps.google.com/maps?q=${encodeURIComponent(city)}&z=11&output=embed`;
};

// âœ… SIDEBAR
document.getElementById("menu-toggle")?.addEventListener("click", () =>
    document.getElementById("sidebar-menu").classList.toggle("open")
);
</script>

<script src="dharshan/chatbot.js"></script>
</body>
</html>
