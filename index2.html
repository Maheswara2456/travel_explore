<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Travel Explorer - Explore Map</title>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">

<style>
  body { margin:0; font-family: Inter, sans-serif; background:#f0f4f8; }

  .top-bar{
    position:fixed;top:0;left:0;right:0;height:60px;background:#fff;
    display:flex;align-items:center;padding:0 16px;
    box-shadow:0 2px 4px rgba(0,0,0,0.06);z-index:50;
  }
  .menu-icon{font-size:22px;cursor:pointer;color:#007bff;margin-right:12px}
  .app-title{color:#007bff;font-weight:700}

  .sidebar{position:fixed;left:-260px;top:0;width:260px;height:100%;background:#fff;
    padding-top:60px;transition:left .25s;z-index:60;box-shadow:2px 0 12px rgba(0,0,0,0.12)}
  .sidebar.open{left:0}
  .sidebar a{display:block;padding:14px 18px;color:#333;text-decoration:none;border-left:5px solid transparent}
  .sidebar a:hover{background:#f7f7f7}
  .active-link{background:#e6f0ff;color:#1e40af;border-left-color:#007bff;font-weight:700}

  #map { height: calc(100vh - 60px); margin-top:60px; }

  .control-bar{
    position:absolute;top:70px;left:50%;transform:translateX(-50%);
    background:#fff;padding:10px;border-radius:10px;display:flex;gap:8px;
    box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:1000;
  }
  select,button{
    padding:8px 12px;border-radius:6px;border:1px solid #ccc;font-weight:600;cursor:pointer;
  }
  button:hover{background:#007bff;color:#fff}
</style>
</head>
<body>

<div class="top-bar">
  <div id="menu-toggle" class="menu-icon">â˜°</div>
  <div class="app-title">Travel Explorer</div>
</div>

<nav id="sidebar-menu" class="sidebar" aria-hidden="true">
  <a href="index.html">ğŸ  Home</a>
  <a href="index2.html" class="active-link">ğŸ—ºï¸ Explore</a>
  <a href="index3.html">â„¹ï¸ About</a>
  <a href="feedback.html">ğŸ—£ï¸ Feedback</a>
  <a href="index4.html">ğŸ“… Trip Planner</a>
  <hr style="margin:12px 0;border-top:1px solid #eee">
  <a href="chatbot.html">ğŸ¤– Chatbot</a>
</nav>

<div class="control-bar">
  <button id="locateBtn">ğŸ“ Get My Location</button>

  <select id="placeType">
    <option value="restaurant">Restaurants</option>
    <option value="hotel">Hotels</option>
    <option value="cinema">Cinemas</option>
    <option value="mall">Shopping</option>
  </select>

  <button id="searchBtn">ğŸ” Search Nearby</button>
</div>

<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
let map, userMarker;
let userLat = null, userLon = null;

// Initialize map
map = L.map('map').setView([20.5937, 78.9629], 5);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom:19 }).addTo(map);

// Get and show user location
document.getElementById("locateBtn").onclick = () => {
  navigator.geolocation.getCurrentPosition(pos => {
    userLat = pos.coords.latitude;
    userLon = pos.coords.longitude;

    map.setView([userLat, userLon], 15);

    if (userMarker) map.removeLayer(userMarker);
    userMarker = L.marker([userLat, userLon]).addTo(map).bindPopup("You Are Here").openPopup();

  }, () => alert("Turn on GPS and try again!"));
};

// Search nearby places
document.getElementById("searchBtn").onclick = () => {
  if (!userLat) return alert("First click 'Get My Location'");

  const type = document.getElementById("placeType").value;

  const query = `
    [out:json][timeout:25];
    (
      node["amenity"="${type}"](around:2000,${userLat},${userLon});
      way["amenity"="${type}"](around:2000,${userLat},${userLon});
      relation["amenity"="${type}"](around:2000,${userLat},${userLon});
    );
    out center;
  `;

  fetch("https://overpass-api.de/api/interpreter", {
    method: "POST",
    body: query
  })
  .then(r => r.json())
  .then(data => {
    data.elements.forEach(p => {
      const lat = p.lat || p.center?.lat;
      const lon = p.lon || p.center?.lon;
      if (!lat) return;
      L.marker([lat, lon]).addTo(map)
       .bindPopup(p.tags.name || type);
    });
  })
  .catch(() => alert("Network blocked temporarily. Try again in 10 sec."));
};
</script>

<script>
document.getElementById('menu-toggle').addEventListener('click', () => {
  document.getElementById('sidebar-menu').classList.toggle('open');
});
</script>

</body>
</html>
